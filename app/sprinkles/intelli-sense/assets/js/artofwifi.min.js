(function(){moment.tz.setDefault(site.time_zone);moment.updateLocale(site.locale.substr(0,2),{week:{dow:1}})})();
var ap_models_array=[{model:"BZ2",full_name:"UAP",dual_band:!1},{model:"BZ2LR",full_name:"UAP LR",dual_band:!1},{model:"U2O",full_name:"UAP Outdoor",dual_band:!1},{model:"U7LT",full_name:"AC-LITE",dual_band:!0},{model:"U7LR",full_name:"AC-LR",dual_band:!0},{model:"U7PG2",full_name:"AC-PRO",dual_band:!0},{model:"U2HSR",full_name:"UAP Outdoor+",dual_band:!1},{model:"p2N",full_name:"PicoStation M2",dual_band:!1},{model:"U2IW",full_name:"AP IN-WALL",dual_band:!1},{model:"U7MSH",full_name:"AC-MESH",dual_band:!0},
{model:"U7MP",full_name:"AC-MESH-PRO",dual_band:!0},{model:"U7HD",full_name:"AC-HD",dual_band:!0}];function getApModelName(a){var b=_.find(ap_models_array,["model",a]);return null==b?a:b.full_name}function isApDualBand(a){a=_.find(ap_models_array,["model",a]);return null==a?!1:a.dual_band}function noGapsDataArray(a,b){if(0<a.length){var c=[a[0]];for(i=1;i<a.length;i++){var d=dateDiff(a[i-1][0],a[i][0],b);if(1<d)for(j=0;j<d-1;j++)c.push([a[i-1][0]+1E3*b,null]);c.push(a[i])}return c}return a}
function dateDiff(a,b,c){return Math.floor((b-a)/(1E3*c))}
if("undefined"!==typeof Highcharts)var weekendAreasDaily4Columns=function(a,b){var c=[],d=moment(b).startOf("week").subtract(50,"weeks").subtract(2,"days").subtract(12,"hours");do c.push({color:"#F5F5F5",from:Number(d.format("x")),to:Number(d.add(2,"days").format("x"))}),d.add(5,"days");while(Number(d.format("x"))<b);return c},weekendAreasDaily=function(a,b){var c=[],d=moment(b).startOf("week").subtract(50,"weeks").subtract(2,"days");do c.push({color:"#F5F5F5",from:Number(d.format("x")),to:Number(d.add(2,
"days").format("x"))}),d.add(5,"days");while(Number(d.format("x"))<b);return c},weekendAreas=function(a,b){var c=[],d=moment(b).startOf("week").subtract(50,"weeks").subtract(2,"days");do c.push({color:"#F5F5F5",from:Number(d.format("x")),to:Number(d.add(2,"days").format("x"))}),d.add(5,"days");while(Number(d.format("x"))<b);return c},highchartsOptions=Highcharts.setOptions({global:{timezoneOffset:-2,useUTC:!1},lang:{loading:'<i class="fa fa-circle-o-notch fa-spin fa-2x"></i>'},plotOptions:{plotBackgroundColor:null,
plotBorderWidth:null,plotShadow:!1,series:{marker:{enabled:!1,radius:2,states:{hover:{enabled:!0}}},states:{hover:{enabled:!0,lineWidth:2}}},pie:{center:["50%","50%"],allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1,distance:10,style:{fontSize:"12px",color:"#000000",fontWeight:"normal"}},animation:{duration:500,easing:"easeInOutQuart"}},bar:{animation:{duration:500,easing:"easeInOutQuart"}},column:{animation:{duration:500,easing:"easeInOutQuart"}},line:{animation:{duration:500,easing:"easeInOutQuart"}},
area:{stacking:"normal",lineWidth:1,animation:{duration:500,easing:"easeInOutQuart"}}},credits:{enabled:!1},colors:"#e25826 #132149 #3E9C1A #232323 #707676 #a069db #DD686E".split(" "),title:!1,subtitle:!1,chart:{backgroundColor:"#FFFFFF",reflow:!0,spacingTop:7,spacingBottom:2,spacingLeft:0,spacingRight:0},xAxis:{tickWidth:0,gridLineColor:"#FAFAFA",gridLineWidth:0},yAxis:{floor:0,title:{text:!1}},tooltip:{style:{fontSize:"8pt"},borderColor:"#003166"},legend:{itemStyle:{fontSize:"12px",color:"#000000",
fontWeight:"normal"}}}),seriesEnd=moment().endOf("day"),seriesStart=seriesEnd-31536E6,weekendsDaily=weekendAreasDaily(seriesStart,seriesEnd),weekendsDaily4Columns=weekendAreasDaily4Columns(seriesStart,seriesEnd),weekends=weekendAreas(seriesStart,seriesEnd);
if($.fn.DataTable){var is_guestRenderFunction=function(a,b,c,d){if("display"===b||"filter"===b)a=a?'<div class="badge badge-info">guest</div>':'<div class="badge badge-primary">user</div>';return a},tx_bytesRenderFunction=function(a,b,c,d){return"display"===b?"undefined"!==typeof a&&a&&0!==a?humanFileSize(a):"0 B":a},rx_bytesRenderFunction=function(a,b,c,d){return"display"===b?"undefined"!==typeof a&&a&&0!==a?humanFileSize(a):"0 B":a},versionRenderFunction=function(a,b,c,d){if("display"===b||"filter"===
b)if("undefined"===typeof a||!a)return"unknown";return a},stateRenderFunction=function(a,b,c,d){if("display"===b||"filter"===b)switch(a){case 1:return!0===c.locating?'<div class="badge badge-primary">flashing</div>':'<div class="badge badge-info">OK</div>';case 0:return'<div class="badge badge-danger">offline</div>';case 5:return'<div class="badge badge-warning">updating</div>';case 6:return'<div class="badge badge-danger">unreachable</div>'}return a},ap_nameRenderFunction=function(a,b,c,d){return"undefined"!==
typeof a&&a?a:c.mac},up_timeRenderFunction=function(a,b,c,d){return"display"===b?moment.duration(a,"seconds").format("d[d] h[h] m[m]"):a},assoc_timeRenderFunction=function(a,b,c,d){return"undefined"!==typeof a&&a?"display"===b||"filter"===b?(a=moment().format("X")-a,moment.duration(a,"seconds").format("d[d] h[u] m[m]")):moment().format("X")-a:"0m"},durationRenderFunction=function(a,b,c,d){return"undefined"!==typeof a?"display"===b?moment.duration(a,"seconds").format("d[d] h[u] m[m]"):a:humanFileSize("0")},
last_seenRenderFunction=function(a,b,c,d){return"display"===b||"filter"===b?moment(1E3*a).format("D MMM YYYY, HH:mm"):a},first_seenRenderFunction=function(a,b,c,d){return"display"===b||"filter"===b?moment(1E3*a).format("D MMM YYYY, HH:mm"):a},hostnameRenderFunction=function(a,b,c,d){return"undefined"!==typeof a?a:"undefined"===typeof c.name?c.mac:c.name},modelRenderFunction=function(a,b,c,d){return"display"===b||"filter"===b?getApModelName(a):a};$.extend(!0,$.fn.DataTable.defaults,{deferRender:!0,
responsive:!0,scrollX:!0,autoWidth:!1,language:{loadingRecords:"",processing:'<i class="fa fa-circle-o-notch fa-spin fa-2x" style="opacity: 0.5;"></i>'}});$.fn.dataTable.ext.errMode="none"}function humanFileSize(a,b){var c=b?1E3:1024;if(Math.abs(a)<c)return a+" B";var d=b?"kB MB GB TB PB EB ZB YB".split(" "):"KiB MiB GiB TiB PiB EiB ZiB YiB".split(" "),e=-1;do a/=c,++e;while(Math.abs(a)>=c&&e<d.length-1);return a.toFixed(1)+" "+d[e]}
function onNavbarMetricsReceived(a){console.log("refreshing navbar metrics (every 5 minutes)");$("#notification_counter").html(a.active_alarms);$("#navbar_notification_counter").html(a.active_alarms);0<a.active_alarms?$("#notification_counter").removeClass("badge-primary").addClass("badge-danger"):$("#notification_counter").removeClass("badge-danger").addClass("badge-primary");$("#span_aps_online").html(a.num_ap);$("#span_aps_offline").html(a.num_disconnected+a.num_disabled);$("#span_aps_total").html(a.num_adopted);
0<a.num_disconnected?$("#span_aps_total").removeClass("badge-primary").addClass("badge-danger"):$("#span_aps_total").removeClass("badge-danger").addClass("badge-primary")}$(window).on("unload",function(){$(window).scrollTop(0)});
function flashToasts(){if("undefined"!==typeof toastr)return $.getJSON(site.uri["public"]+"/alerts",{}).then(function(a){a&&jQuery.each(a,function(a,c){var b=$("#toast-container");0<b.length?(b=b.find(".toast-error"),0<b.length&&(b=b.find(".toast-message").text(),c.message.toUpperCase()!==b.toUpperCase()&&(console.log("toastr message not the same as previous"),"success"==c.type?toastr.success(c.message):"warning"==c.type?toastr.warning(c.message):"info"==c.type?toastr.info(c.message):"danger"==c.type&&
toastr.error(c.message)))):"success"==c.type?toastr.success(c.message):"warning"==c.type?toastr.warning(c.message):"info"==c.type?toastr.info(c.message):"danger"==c.type&&toastr.error(c.message)})})}
$(document).ready(function(){function a(){$.ajax({url:site.uri["public"]+"/api/dashboard/navbar_metrics",type:"GET",dataType:"json",success:onNavbarMetricsReceived,error:flashToasts})}window.setTimeout(function(){console.log("session expired after 30 minutes, logging off...");window.location.href=site.uri["public"]+"/account/logout"},18E5);$(function(){$('[data-toggle="tooltip"]').tooltip({container:"body"})});$("#venue_selection li.venue_id").click(function(a){a.preventDefault();a=$("meta[name=current_venue]").attr("content");
var b=$("meta[name=base_url]").attr("content");if($(this).attr("id").replace("venue_","")!==a){a=$(this).attr("id").replace("venue_","");var d=$(this).find("a").text();console.log("requested switch to venue: "+d);toastr.success("Switching to venue: "+d);$.ajax({url:b+"/users/switch_venue/"+a+"/"+b,type:"GET",dataType:"json",success:function(a){console.log("venue switch approved and done");"OK"===a?window.location.reload(!0):window.location.replace(b+"/"+a)},error:flashToasts})}});$(document).on("click",".panel-heading span.clickable",
function(a){a=$(this);a.hasClass("panel-collapsed")?(a.parents(".panel").find(".panel-content").slideDown(),a.removeClass("panel-collapsed"),a.find("i").removeClass("fa-chevron-down").addClass("fa-chevron-up")):(a.parents(".panel").find(".panel-content").slideUp(),a.addClass("panel-collapsed"),a.find("i").removeClass("fa-chevron-up").addClass("fa-chevron-down"))});$.fn.DataTable&&$(window).resize(function(){$.fn.DataTable.tables({visible:!0,api:!0}).columns.adjust()});window.dispatchEvent(new Event("resize"));
"undefined"!==typeof site.uri["public"]&&"undefined"==typeof no_alarm_fetching&&(a(),setInterval(a,3E5))});